"use strict";(self["webpackChunkavtomaslo"]=self["webpackChunkavtomaslo"]||[]).push([[142],{60690:function(e,t,n){n.d(t,{x:function(){return p}});var a=n(50124),r=n(48534),o=(n(69826),n(41539),n(92222),n(57327),n(38862),n(57658),n(44870)),i=n(50086),u=n(46943),c=n(13854),p=(0,c.Q_)("categories",(function(){var e=(0,o.iH)([]);function t(t,n){var a=e.value.find((function(e){return e._id==t}));a.imageUrl=n,a.updated=!0}function c(){return p.apply(this,arguments)}function p(){return p=(0,r.Z)((0,a.Z)().mark((function t(){var n;return(0,a.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,u.Z.get("".concat(i.Z.API_URL,"/categories"));case 2:n=t.sent,e.value=n.data;case 4:case"end":return t.stop()}}),t)}))),p.apply(this,arguments)}function l(e){return s.apply(this,arguments)}function s(){return s=(0,r.Z)((0,a.Z)().mark((function e(t){var n;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,u.Z.get("".concat(i.Z.API_URL,"/categories/").concat(t));case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)}))),s.apply(this,arguments)}function d(e){return g.apply(this,arguments)}function g(){return g=(0,r.Z)((0,a.Z)().mark((function t(n){var r,o,c;return(0,a.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,r=localStorage.getItem("token")?localStorage.getItem("token"):"",o={"Content-Type":"application/json",Authorization:"Bearer ".concat(r)},t.next=5,u.Z["delete"]("".concat(i.Z.API_URL,"/categories/").concat(n),{headers:o});case 5:t.sent,c=e.value.filter((function(e){return e._id!=n})),e.value=c,t.next=14;break;case 10:t.prev=10,t.t0=t["catch"](0),console.log(t.t0),alert("Ошибка");case 14:case"end":return t.stop()}}),t,null,[[0,10]])}))),g.apply(this,arguments)}function f(e){return m.apply(this,arguments)}function m(){return m=(0,r.Z)((0,a.Z)().mark((function t(n){var r,o,c;return(0,a.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,r=localStorage.getItem("token")?localStorage.getItem("token"):"",o={"Content-Type":"application/json",Authorization:"Bearer ".concat(r)},t.next=5,u.Z.post("".concat(i.Z.API_URL,"/categories"),JSON.stringify(n),{headers:o});case 5:c=t.sent,e.value.push(c.data),t.next=13;break;case 9:t.prev=9,t.t0=t["catch"](0),console.log(t.t0),alert("Ошибка");case 13:case"end":return t.stop()}}),t,null,[[0,9]])}))),m.apply(this,arguments)}function h(e,t){return v.apply(this,arguments)}function v(){return v=(0,r.Z)((0,a.Z)().mark((function e(t,n){var r,o;return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,r=localStorage.getItem("token")?localStorage.getItem("token"):"",o={"Content-Type":"application/json",Authorization:"Bearer ".concat(r)},e.next=5,u.Z.put("".concat(i.Z.API_URL,"/categories/").concat(t),JSON.stringify(n),{headers:o});case 5:e.sent,n.updated=!1,e.next=13;break;case 9:e.prev=9,e.t0=e["catch"](0),console.log(e.t0),alert("Ошибка");case 13:case"end":return e.stop()}}),e,null,[[0,9]])}))),v.apply(this,arguments)}function w(e){return e.imageUrl?i.Z.API_URL+e.imageUrl:n(1802)}return{categories:e,fetchCategoreis:c,getImageUrl:w,deleteCategory:d,createCategory:f,fetchCategory:l,updateCategory:h,updateCategoryImage:t}}))},4903:function(e,t,n){n.d(t,{Z:function(){return y}});n(92222);var a=n(73396),r=n(87139),o=function(e){return(0,a.dD)("data-v-f8d050ea"),e=e(),(0,a.Cn)(),e},i={class:"input-group"},u=["src"],c=o((function(){return(0,a._)("div",{class:"image-overlay"},[(0,a._)("span",null,"Нажмите, чтобы загрузить или обновить изображение")],-1)})),p={key:1,class:"image-wrap-text"};function l(e,t,n,o,l,s){return(0,a.wg)(),(0,a.iD)("div",i,[(0,a._)("label",{class:"image-wrap",style:(0,r.j5)("width: ".concat(n.wrapSize,"px; height: ").concat(n.wrapSize,"px"))},[o.imageUrl?((0,a.wg)(),(0,a.iD)("img",{key:0,src:o.config.API_URL+o.imageUrl,style:(0,r.j5)("max-width: ".concat(n.imageMaxWidth,"px; max-height: ").concat(n.imageMaxWidth,"px;")),class:"image-wrap-img",alt:""},null,12,u)):(0,a.kq)("",!0),c,o.imageUrl?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("span",p,"Нажмите, чтобы загрузить или обновить изображение")),(0,a._)("input",{type:"file",ref:"fileInput",onChange:t[0]||(t[0]=function(){return o.handleFileInputChange&&o.handleFileInputChange.apply(o,arguments)})},null,544)],4)])}var s=n(50124),d=n(48534),g=n(44870),f=n(46943),m=n(50086),h={props:["imageUrlProp","extraInfo","imageMaxWidth","wrapSize"],emits:["updateImage"],setup:function(e,t){var n=(0,g.iH)(null),r=(0,g.iH)("");function o(){return i.apply(this,arguments)}function i(){return i=(0,d.Z)((0,s.Z)().mark((function e(){return(0,s.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:n.value.files[0]&&u();case 1:case"end":return e.stop()}}),e)}))),i.apply(this,arguments)}function u(){return c.apply(this,arguments)}function c(){return c=(0,d.Z)((0,s.Z)().mark((function a(){var o,i,u,c;return(0,s.Z)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return o=new FormData,o.append("file",n.value.files[0]),i=localStorage.getItem("token")?localStorage.getItem("token"):"",u={"Content-Type":"multipart/form-data",Authorization:"Bearer ".concat(i)},a.next=6,f.Z.post("".concat(m.Z.API_URL,"/upload"),o,{headers:u});case 6:c=a.sent,r.value="/uploads/"+c.data.filename,t.emit("updateImage","/uploads/"+c.data.filename,e.extraInfo);case 9:case"end":return a.stop()}}),a)}))),c.apply(this,arguments)}return(0,a.bv)((function(){r.value=e.imageUrlProp})),(0,a.ic)((function(){r.value=e.imageUrlProp})),{handleFileInputChange:o,fileInput:n,imageUrl:r,config:m.Z}}},v=n(40089);const w=(0,v.Z)(h,[["render",l],["__scopeId","data-v-f8d050ea"]]);var y=w},74142:function(e,t,n){n.r(t),n.d(t,{default:function(){return L}});n(68309);var a=n(73396),r=n(49242),o=n(87139),i=function(e){return(0,a.dD)("data-v-2b910514"),e=e(),(0,a.Cn)(),e},u={class:"container"},c=i((function(){return(0,a._)("h4",{style:{"margin-bottom":"20px"}},"Категории",-1)})),p={class:"categories"},l=["onSubmit"],s={class:"input-group"},d=i((function(){return(0,a._)("div",{class:"input-group-prepend"},[(0,a._)("span",{class:"input-group-text",id:""},"ID")],-1)})),g=["onInput","onUpdate:modelValue"],f={class:"input-group"},m=i((function(){return(0,a._)("div",{class:"input-group-prepend"},[(0,a._)("span",{class:"input-group-text",id:""},"Название")],-1)})),h=["onInput","onUpdate:modelValue"],v=["onClick"],w={class:"input-group"},y=i((function(){return(0,a._)("div",{class:"input-group-prepend"},[(0,a._)("span",{class:"input-group-text",id:""},"ID")],-1)})),x={class:"input-group"},Z=i((function(){return(0,a._)("div",{class:"input-group-prepend"},[(0,a._)("span",{class:"input-group-text",id:""},"Название")],-1)})),I=i((function(){return(0,a._)("button",{type:"submit",class:"btn btn-secondary"},"Добавить",-1)}));function _(e,t,n,i,_,U){var k=(0,a.up)("ImageUploader");return(0,a.wg)(),(0,a.iD)("div",u,[c,(0,a._)("div",p,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(i.categories,(function(e){return(0,a.wg)(),(0,a.iD)("form",{onSubmit:(0,r.iM)((function(t){return i.handleUpdate(e._id,e)}),["prevent"]),class:"category",key:e._id},[(0,a.Wm)(k,{extraInfo:{id:e._id},imageMaxWidth:500,wrapSize:500,onUpdateImage:i.updateImage,imageUrlProp:e.imageUrl},null,8,["extraInfo","onUpdateImage","imageUrlProp"]),(0,a._)("div",s,[d,(0,a.wy)((0,a._)("input",{onInput:function(t){return e.updated=!0},placeholder:"Без пробелов на англ. языке",class:"form-control",required:"","onUpdate:modelValue":function(t){return e.slug=t}},null,40,g),[[r.nr,e.slug]])]),(0,a._)("div",f,[m,(0,a.wy)((0,a._)("textarea",{onInput:function(t){return e.updated=!0},class:"form-control",required:"","onUpdate:modelValue":function(t){return e.name=t}},null,40,h),[[r.nr,e.name]])]),e.updated?((0,a.wg)(),(0,a.iD)("button",{key:0,type:"submit",style:{"margin-right":"10px"},class:(0,o.C_)(["btn",{"btn-secondary":e.updated}])}," Сохранить ",2)):(0,a.kq)("",!0),(0,a._)("button",{type:"button",onClick:function(t){return i.handleDelete(e._id)},class:"btn btn-danger"}," Удалить ",8,v)],40,l)})),128)),(0,a._)("form",{class:"category",onSubmit:t[2]||(t[2]=(0,r.iM)((function(){return i.handleCreate&&i.handleCreate.apply(i,arguments)}),["prevent"]))},[(0,a.Wm)(k,{imageUrlProp:i.newCategory.imageUrl,imageMaxWidth:500,wrapSize:500,extraInfo:{id:"new"},onUpdateImage:i.updateImage},null,8,["imageUrlProp","onUpdateImage"]),(0,a._)("div",w,[y,(0,a.wy)((0,a._)("input",{placeholder:"Без пробелов на англ. языке",class:"form-control",required:"","onUpdate:modelValue":t[0]||(t[0]=function(e){return i.newCategory.slug=e})},null,512),[[r.nr,i.newCategory.slug]])]),(0,a._)("div",x,[Z,(0,a.wy)((0,a._)("textarea",{class:"form-control",required:"","onUpdate:modelValue":t[1]||(t[1]=function(e){return i.newCategory.name=e})},null,512),[[r.nr,i.newCategory.name]])]),I],32)])])}var U=n(50124),k=n(48534),C=n(44870),b=n(13854),S=n(60690),P=n(4903),D={components:{ImageUploader:P.Z},setup:function(){var e=(0,b.Jk)((0,S.x)()),t=e.categories,n=(0,S.x)(),r=n.createCategory,o=n.fetchCategoreis,i=n.updateCategoryImage,u=n.updateCategory,c=n.deleteCategory,p=(0,C.iH)({imageUrl:"",name:"",slug:""});function l(e,t){"new"!=t.id?i(t.id,e):p.value.imageUrl=e}function s(){return d.apply(this,arguments)}function d(){return d=(0,k.Z)((0,U.Z)().mark((function e(){return(0,U.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,r(p.value);case 2:p.value.imageUrl="",p.value.name="";case 4:case"end":return e.stop()}}),e)}))),d.apply(this,arguments)}function g(e,t){return f.apply(this,arguments)}function f(){return f=(0,k.Z)((0,U.Z)().mark((function e(t,n){return(0,U.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,u(t,n);case 2:alert("Успешно");case 3:case"end":return e.stop()}}),e)}))),f.apply(this,arguments)}function m(e){return h.apply(this,arguments)}function h(){return h=(0,k.Z)((0,U.Z)().mark((function e(t){return(0,U.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!confirm("Удалить категорию?")){e.next=3;break}return e.next=3,c(t);case 3:case"end":return e.stop()}}),e)}))),h.apply(this,arguments)}return(0,a.bv)((0,k.Z)((0,U.Z)().mark((function e(){return(0,U.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,o();case 2:case"end":return e.stop()}}),e)})))),{categories:t,updateImage:l,newCategory:p,handleCreate:s,handleUpdate:g,handleDelete:m}}},A=n(40089);const z=(0,A.Z)(D,[["render",_],["__scopeId","data-v-2b910514"]]);var L=z},1802:function(e,t,n){e.exports=n.p+"img/placeholder.d5f1d603.jpg"}}]);
//# sourceMappingURL=142-legacy.ce61f31f.js.map